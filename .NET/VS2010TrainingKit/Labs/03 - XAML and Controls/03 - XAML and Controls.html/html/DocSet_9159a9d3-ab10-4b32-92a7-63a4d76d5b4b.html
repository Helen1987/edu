<html dir="ltr" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:xlink="http://www.w3.org/1999/xlink">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="save" content="history" />
    <xml>
      <MSHelp:TOCTitle Title="Exercise 2: Creating a Form Entry to Edit Interface Details" />
      <MSHelp:RLTitle Title="Exercise 2: Creating a Form Entry to Edit Interface Details" />
      <MSHelp:Attr Name="DocSet" Value="docSet" />
      <MSHelp:Attr Name="TopicType" Value="kbOrient" />
      <MSHelp:Attr Name="Locale" Value="kbEnglish" />
      <MSHelp:Attr Name="AssetId" Value="{GUID}" />
    </xml>
    <title>Exercise 2: Creating a Form Entry to Edit Interface Details</title>
    <link rel="stylesheet" type="text/css" href="../local/Classic.css" />
    <script src="../local/EventUtilities.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/SplitScreen.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/Dropdown.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/script.js" type="text/javascript" language="jscript"> </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle" />
    <input type="hidden" id="hiddenScrollOffset" />
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="DropDown image" src="../local/drpdown.gif" />
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif" />
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif" />
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif" />
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif" />
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif" />
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif" />
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif" />
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">Working with Panels, XAML, and Controls</span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Exercise 2: Creating a Form Entry to Edit Interface Details</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td />
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0" style="cursor:default;display:none;">
              <img id="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif" />
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span>
            <span id="languageFilterToolTip" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0" style="cursor:default;">
              <img id="languageFilterImage" alt="DropDown image" src="../local/drpdown.gif" />
              <label id="showAllLabel" for="languageFilterImage" style="display: none;">Language Filter: All</label>
              <label id="multipleLabel" for="languageFilterImage" style="display: none;">Language Filter: Multiple</label>
              <label id="vbLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label>
              <label id="csLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
            </span>
          </td>
        </tr>
      </table>
      <div id="languageSpan">
        <input type="checkbox" name="languageFilter" onclick="SetLanguage(this)" id="vbUsageCheckbox" />
        <label class="languageFilter" for="vbUsageCheckbox">Visual Basic Usage</label>
        <br />
        <input type="checkbox" name="languageFilter" onclick="SetLanguage(this)" id="csCheckbox" />
        <label class="languageFilter" for="csCheckbox">C#</label>
        <br />
      </div>
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" />
        <p>Creating an UI for an entry form lends itself to the creation of a page.  In ASP.NET you would create a WebForm.  In a Silverlight project, a UserControl used to create a new page.  In this exercise you will learn how to create a new UserControl and create a data entry form.  </p>
        <p><b>Creating a Form Entry</b></p>
        <ol>
          <li>To add a new <b>UserControl</b>, right click on the solution name in the solution explorer and select ‘<b>add-&gt;New Item</b>’.<p><img src="images\df7e0f9f-1139-49a2-8e08-b0343cc970b7.png" /></p><p><b>Figure 1</b><br /><i>Add new Item</i></p></li>
          <li>Select <b>Silverlight User Control</b> from the menu<p><img src="images\0c9a5576-30b5-4f74-8fac-7424c0290607.png" /></p><p><b>Figure 2</b><br /><i>Add new item Menu</i></p></li>
          <li>Rename the Control to ‘<b>EditDetails.xaml</b>’ in the bottom of the Add New Item window, and click ‘Add’.</li>
          <li>Next create the form entries for each field in the <b>DataGrid </b>(Name, Image, Address, Email, Phone number, and Website). Using the Toolbox in Visual Studio, add 6 <b>TextBox </b>controls. Edit the ‘<b>Text</b>’ attribute for each block to add default text. <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>XAML</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>&lt;TextBox Height="23" HorizontalAlignment="Left" Margin="12,16,0,0" Name="textBox1" VerticalAlignment="Top" Width="348" Text="Name" /&gt;&lt;TextBox Height="23" HorizontalAlignment="Left" Margin="12,46,0,0" Name="textBox2" VerticalAlignment="Top" Width="348" Text="Image Location"/&gt;&lt;TextBox Height="23" HorizontalAlignment="Left" Margin="12,74,0,0" Name="textBox3" VerticalAlignment="Top" Width="348" Text="Address"/&gt;&lt;TextBox Height="23" HorizontalAlignment="Left" Margin="12,104,0,0" Name="textBox4" VerticalAlignment="Top" Width="348" Text="Email"/&gt;&lt;TextBox Height="23" HorizontalAlignment="Left" Margin="10,134,0,0" Name="textBox5" VerticalAlignment="Top" Width="350" Text="Phone Number"/&gt;&lt;TextBox Height="23" HorizontalAlignment="Left" Margin="10,164,0,0" Name="textBox6" VerticalAlignment="Top" Width="350" Text="Website"/&gt;</pre></td></tr></table></span></div><p><img src="images\b6b8ea0e-3524-462b-9172-a0bab1f78e0e.png" /></p><p><b>Figure 3</b><br /><i>The resulting UI</i></p></li>
          <li>Place the new <b>UserControl</b> inside the <b>MainPage</b> View. Before you can do that, you must build the project in order the UserControl to show up in the Toolboox.  </li>
          <li>Select <b>MainPage.xaml</b> and open the Toolbox. There should be a new entry at the top of your list.<p><img src="images\2017338d-4ffc-4dfa-ba92-97c31d5049ca.png" /></p><p><b>Figure 4</b><br /><i>The EditContacts User Control in the toolbox</i></p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td> You must have a page other than <b>EditContacts.xaml</b> as your currently open document for EditContacts to appear in the toolbox.</td></tr></table><p /></div><br /></li>
          <li>Much like adding the DataGrid, add the EditContacts UserControl by dragging and dropping onto the design view.</li>
          <li>Look at the Xaml and notice there is a new xml namespace, <b>xmlns:my</b>.  This represents the current project, and lets the runtime know where to find the control. <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>XAML</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>xmlns:my="clr-namespace:PanelsControlsLab"</pre></td></tr></table></span></div><p><img src="images\87b506c5-f490-4010-9bb5-ec17be36629a.png" /></p><p><b>Figure 5</b><br /><i>The resulting UI</i></p></li>
          <li>At the top of the page, add a button to enable the user to open up the Add Contact interface. Drag and Drop a <b>ToggleButton </b>onto the design view. You can edit the <b>Content</b> attribute of the <b>ToggleButton</b> to say “Add new contact”.<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td>If you don’t see the ToggleButton in the Toolbox, add it by right clicking the Toolbox and select Choose Items from the context menu.</td></tr></table><p /></div><p><img src="images\8142b5ca-960d-4cda-830c-c63b87524bc6.png" /></p><p><b>Figure 6</b><br /><i>Right click the toolbox and select Choose Items…</i></p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td>From the Choose Toolbox Items dialog box, Find and select the <b>ToggleButton</b>.  Now the <b>ToggleButton</b> is added to the Toolbox, find it and click and add it to your UI.</td></tr></table><p /></div><p><img src="images\e2149053-2115-400f-9d9e-a8a3270fedb5.png" /></p><p><b>Figure 7</b><br /><i>Find ToggleButton under Silverlight Components</i></p></li>
          <li>The EditContacts UserControl should only be visible when the ToggleButton is checked, make sure this window doesn’t open by default.   Right click on the EditDetails control and click properties to open the properties window. By default, the Properties panel opens in the bottom right and corner of the screen. <p><img src="images\67c3d49a-8e34-441e-85c5-d079e06a922a.png" /></p><p><b>Figure 8</b><br /><i>In this window you can edit the visual properties of whatever control you have selected at the moment. For now, you  want the default visibility set to Collapsed.</i></p></li>
          <li>Next, wire up that <b>ToggleButton</b> to hide and show the <b>EditDetails</b> control. In order to set this property, add an event handler to the code-behind. <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td><b>Note:</b>There’s a shortcut if you want to add an Event Handler. If you select “Events” in the properties window of the <b>CheckBox</b> control, you’ll see an event labeled <b>Checked</b>. Double-click that event to automatically generate the event handler for the <b>CheckBox</b>. Do the same once more for the <b>UnChecked</b> event.</td></tr></table><p /></div></li>
          <li>In the <b>AddContactButton_Checked</b> handler, set the visibility of the <b>EditContacts</b> control to <b>System.Windows.Visibility.Visible</b>. In the <b>AddContactButton_UnChecked</b> handler set it to <b>System.Windows.Visibility.Collapsed</b>. Your <b>MainPage.xaml.cs</b> or <b>MainPage.xaml.vb</b> should look like this:<div class="code"><span codeLanguage="CSharp"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C#</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>namespace PanelsControlsLab{        public partial class MainPage : UserControl        {                public MainPage()                {                        InitializeComponent();                }                private void AddContactButton_Checked(object sender,  System.Windows.RoutedEventArgs e)                {                        this.AddContactPanel.Visibility =   System.Windows.Visibility.Visible;                }                private void AddContactButton_Unchecked(object sender,  RoutedEventArgs e)                {                        this.AddContactPanel.Visibility =System.Windows.Visibility.Collapsed;                }        }}</pre></td></tr></table></span></div><div class="code"><span codeLanguage="VisualBasicUsage"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>Visual Basic</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>Namespace PanelsControlsLab        Partial Public Class MainPage                Inherits UserControl                Public Sub New()                        InitializeComponent()                End Sub                Private Sub AddContactButton_Checked(ByVal sender As Object,ByVal e As System.Windows.RoutedEventArgs)                        Me.AddContactPanel.Visibility = System.Windows.Visibility.Visible                End Sub                Private Sub AddContactButton_Unchecked(ByVal sender As Object, ByVal e As RoutedEventArgs)                        Me.AddContactPanel.Visibility = System.Windows.Visibility.Collapsed                End Sub        End ClassEnd Namespace</pre></td></tr></table></span></div></li>
          <li>Next add a button that will add the data entered in these fields into our DataGrid. Open <b>EditContacts.xaml</b> and drag a button onto the bottom of the UserControl. Set the text of the button to <b>Add Contact</b>.<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td> (A simple border around the edit contacts window has been added, and set the Height and Width of <b>editContacts1</b> in MainPage.Xaml to ‘Auto’. This was done entirely for aesthetic purposes, and is optional).</td></tr></table><p /></div><p><img src="images\15a34829-ab13-4da4-ac77-78116892dfd3.png" /></p><p><b>Figure 9</b><br /><i>The finished EditContacrs in the MainPage.xaml designer</i></p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>XAML</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>&lt;Button Content="Add Contact" Height="23" HorizontalAlignment="Left" Margin="224,194,0,0" Name="button1" VerticalAlignment="Top" Width="136" /&gt;&lt;Border BorderThickness="1" Height="227" HorizontalAlignment="Left" Name="border1" VerticalAlignment="Top" Width="372"&gt;        &lt;Border.BorderBrush&gt;                &lt;LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5"&gt;                        &lt;GradientStop Color="Black" Offset="0" /&gt;                        &lt;GradientStop Color="#FF443B3B" Offset="1" /&gt;                &lt;/LinearGradientBrush&gt;        &lt;/Border.BorderBrush&gt;&lt;/Border&gt;</pre></td></tr></table></span></div></li>
          <li>That’s it! Run your program to see the finished product. Here what it will look like:<p><img src="images\c47fc76f-d8a8-418c-9cdf-69c46ebf7ff0.png" /></p><p><b>Figure 10</b><br /><i>The completed program</i></p></li>
        </ol>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
        <p>
          <b>
          </b>
        </p>
      </div>
      <div id="footer">
        <div class="footerLine">
          <img src="../local/footer.gif" alt="Footer image" width="100%" height="3px" />
        </div>To give feedback please write to jopapa@microsoft.com<p />Copyright © 2011 by Microsoft Corporation. All rights reserved.</div>
    </div>
  </body>
</html>