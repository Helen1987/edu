<html dir="ltr" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:xlink="http://www.w3.org/1999/xlink">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="save" content="history" />
    <xml>
      <MSHelp:TOCTitle Title="Exercise 1: Experiment with the New Windows 7 Taskbar Features" />
      <MSHelp:RLTitle Title="Exercise 1: Experiment with the New Windows 7 Taskbar Features" />
      <MSHelp:Attr Name="DocSet" Value="docSet" />
      <MSHelp:Attr Name="TopicType" Value="kbOrient" />
      <MSHelp:Attr Name="Locale" Value="kbEnglish" />
      <MSHelp:Attr Name="AssetId" Value="{GUID}" />
    </xml>
    <title>Exercise 1: Experiment with the New Windows 7 Taskbar Features</title>
    <link rel="stylesheet" type="text/css" href="../local/Classic.css" />
    <script src="../local/EventUtilities.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/SplitScreen.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/Dropdown.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/script.js" type="text/javascript" language="jscript"> </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle" />
    <input type="hidden" id="hiddenScrollOffset" />
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="DropDown image" src="../local/drpdown.gif" />
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif" />
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif" />
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif" />
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif" />
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif" />
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif" />
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif" />
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">Taskbar with Visual C++ and MFC</span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Exercise 1: Experiment with the New Windows 7 Taskbar Features</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td />
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0" style="cursor:default;display:none;">
              <img id="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif" />
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span>
            <span id="languageFilterToolTip" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0" style="cursor:default;">
              <img id="languageFilterImage" alt="DropDown image" src="../local/drpdown.gif" />
              <label id="showAllLabel" for="languageFilterImage" style="display: none;">Language Filter: All</label>
              <label id="multipleLabel" for="languageFilterImage" style="display: none;">Language Filter: Multiple</label>
              <label id="vbLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label>
              <label id="csLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
            </span>
          </td>
        </tr>
      </table>
      <div id="languageSpan">
        <input type="checkbox" name="languageFilter" onclick="SetLanguage(this)" id="vbUsageCheckbox" />
        <label class="languageFilter" for="vbUsageCheckbox">Visual Basic Usage</label>
        <br />
        <input type="checkbox" name="languageFilter" onclick="SetLanguage(this)" id="csCheckbox" />
        <label class="languageFilter" for="csCheckbox">C#</label>
        <br />
      </div>
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" />
        <p>In this exercise, you will experiment with the new Windows 7 taskbar features. You will extend a showcase application that demonstrates the use of the new taskbar functionality to provide a taskbar overlay icon, progress bar, jump list, and thumbnail previews. Most of the application’s user interface is already implemented; you will need to fill in only the missing parts that interact with the Windows 7 taskbar using Visual C++ MFC (Microsoft Foundation Class Library).</p>
        <p>To begin this exercise, open the <i>TaskbarDemo_Starter\TaskbarDemo.sln</i> solution (under the Source folder) using Visual Studio 2010.</p>
        <p>
          <img src="images\2bf5af5d-fc78-4601-b5f4-033959485963.png" />
        </p>
        <p>
          <b>Figure 2</b>
          <br />
          <i>Taskbar Concepts solution structure in Visual Studio 2010</i>
        </p>
        <br />
        <p>Spend a minute or two exploring the header, source and resource files. Take a look at the various dialogs and main form. Take a few moments to build and run the application as well.</p>
        <a name="_Toc280793656" href="#">
          <span />
        </a>
        <a name="_Toc236825878" href="#">
          <span />
        </a>
        <p>
          <b>Task 1—Using Taskbar Overlay Icons</b>
        </p>
        <ol>
          <li>In this task, you will toggle an overlay icon on the application’s taskbar button when a user clicks an icon button.</li>
        </ol>
        <p>Note that in MFC, you can set an overlay icon by using CFrameWnd::SetTaskbarOverlayIcon(). To clear the Taskbar overlay icon, pass NULL (0) to SetTaskbarOverlayIcon().</p>
        <ol>
          <li>In the TaskbarDemo\SourceFiles sub tree, open OverlayIconTab.cpp and look for the message handler for the Info overlay icon, COverlayIconTab::OnOverlayIconInfo(). We’ll use this message handler to add the code necessary to set the same icon in the button as a Taskbar overlay icon.</li>
          <li>Add the following code to COverlayIconTab::OnOverlayIconInfo():<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>CMainFrame* mainFrm = dynamic_cast&lt;CMainFrame*&gt;(AfxGetApp()-&gt;GetMainWnd());if (mainFrm)    mainFrm-&gt;SetTaskbarOverlayIcon(IDI_ICON_INFO,L"Info");</pre></td></tr></table></span></div><br /></li>
          <li>Compile and run the application.</li>
          <li>Press the information button (<img src="images\47269915-399b-4b04-90b1-ed9a7b678118.png" />).</li>
          <li>Notice that the display on the taskbar has changed, from the original (<img src="images\bd0cb564-50cf-45da-981f-12e02b91f967.png" />), and now contains an overlay of the information button (<img src="images\ca299032-0bdc-492f-a40e-49752e1eb128.png" />) superimposed on it (see Figure 3 below).<p><img src="images\21283e9f-f319-4b3e-b8ef-f7b8a6ef876b.png" /></p><p><b>Figure 3</b><br /><i>Taskbar overlay icon shown</i></p><br /></li>
          <li>Continue adding the necessary code for the rest of the icon overlay message handlers:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>void COverlayIconTab::OnOverlayIconQuestion(){    // TODO: Add code to set question overlay icon    CMainFrame* mainFrm = dynamic_cast&lt;CMainFrame*&gt;(AfxGetApp()-&gt;GetMainWnd());    if (mainFrm)        mainFrm-&gt;SetTaskbarOverlayIcon(IDI_ICON_QUESTION, L"Question");    }void COverlayIconTab::OnOverlayIconNoVolume(){    // TODO: Add code to set no-volume overlay icon    CMainFrame* mainFrm = dynamic_cast&lt;CMainFrame*&gt;(AfxGetApp()-&gt;GetMainWnd());    if (mainFrm)        mainFrm-&gt;SetTaskbarOverlayIcon(IDI_ICON_NO_VOLUME,L"No Volume"); }void COverlayIconTab::OnOverlayIconNone(){    // TODO: Add code to clear overlay icon    CMainFrame* mainFrm = dynamic_cast&lt;CMainFrame*&gt;(AfxGetApp()-&gt;GetMainWnd());    if (mainFrm)                                               mainFrm-&gt;SetTaskbarOverlayIcon((HICON)0, L"");       }</pre></td></tr></table></span></div><br /></li>
          <li>Build and run the demo to test the remaining icon overlays.</li>
        </ol>
        <a name="_Toc280793657" href="#">
          <span />
        </a>
        <p>
          <b>Task 2—Using Taskbar Progress Bars</b>
        </p>
        <a name="_Toc236825879" href="#">
          <span />
        </a>
        <p>In this task, you will set the state and value of the application’s taskbar progress bar when the user selects the progress state from a combo box or changes the value by using a slider. MFC provides a number of methods to update the Taskbar progress bar’s value and status:</p>
        <ul>
          <li>CFrameWnd::SetProgressBarRange()</li>
          <li>CFrameWnd::SetProgressBarPosition()</li>
          <li>CFrameWnd::SetProgressBarState()</li>
        </ul>
        <ol>
          <li>In the TaskbarDemo\SourceFiles sub tree:<ol><li>Open the file ProgressBarTab.cpp, and </li><li>Look for the slider control’s message handler, CProgressBarTab::OnHScroll()</li><li>Add the following code to update the Taskbar’s progress bar after the comment to add code to handle the slide bar change:</li></ol></li>
          <div class="code">
            <span codeLanguage="ManagedCPlusPlus">
              <table width="100%" cellspacing="0" cellpadding="0">
                <tr>
                  <th>C++</th>
                  <th>
                    <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                      <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                  </th>
                </tr>
                <tr>
                  <td colspan="2">
                    <pre>UpdateData();CMainFrame* mainFrm = dynamic_cast&lt;CMainFrame*&gt;(AfxGetApp()-&gt;GetMainWnd());mainFrm-&gt;SetProgressBarPosition(m_ProgressSliderValue);</pre>
                  </td>
                </tr>
              </table>
            </span>
          </div>
          <br />
          <li>Build and run the application, and then:<ol><li>Go to the Progress Bar tab. </li><li>Move the slider, and notice the movement on the application’s Taskbar button. You should see an output similar to Figure 4 below:</li></ol></li>
          <p>
            <img src="images\36cd1bd0-f9ce-4be6-b8b0-ac718209b4ab.png" />
          </p>
          <p>
            <b>Figure 4</b>
            <br />
            <i>Slider bar and taskbar button progress indicators</i>
          </p>
          <br />
          <li>Now, we want to update the status of the progress bar whenever the relevant combo box option is updated, so we add the necessary code to the CProgressBarTab::OnCbnSelchangeProgressStatusCombo() event handler:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>CMainFrame* mainFrm = dynamic_cast&lt;CMainFrame*&gt;(AfxGetApp()-&gt;GetMainWnd());switch (m_ProgrssStatusCombo.GetCurSel()){case 0 :    mainFrm-&gt;SetProgressBarState(TBPF_NORMAL);    break;case 1 :    mainFrm-&gt;SetProgressBarState(TBPF_ERROR);    break;case 2 :    mainFrm-&gt;SetProgressBarState(TBPF_PAUSED);    break;case 3 :    mainFrm-&gt;SetProgressBarState(TBPF_INDETERMINATE);    break;case 4 :    mainFrm-&gt;SetProgressBarState(TBPF_NOPROGRESS);    break;default:    mainFrm-&gt;SetProgressBarState(TBPF_NORMAL);}</pre></td></tr></table></span></div><br /></li>
          <li> Build and run the application, and then: <ol><li>Navigate to the Progress Bar tab, and </li><li>Select a different style from the Progress Status Combo and then </li><li>Move the progress slider. The progress bar state will be changed to the appropriate style; namely, the taskbar’s progress bar is red when the Progress Status is set to Error, the taskbar’s progress bar is green when the Progress Status is set to Normal (check out the other styles too):</li></ol></li>
          <p>
            <img src="images\e6c415e7-21b0-4538-a5a7-38aea64b4895.png" />
          </p>
          <p>
            <b>Figure 5</b>
            <br />
            <i>Red progress bar indicating error</i>
          </p>
          <br />
          <li>Finally, this last step is optional, but you might want to reset the status combo to ‘Normal’ whenever the progress is updated from No Progress or Intermediate. To fix this, add the following at the end of CProgressBarTab::OnHScroll():<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>if (m_ProgressSliderValue &gt; 0 &amp;&amp; m_ProgrssStatusCombo.GetCurSel() &gt;= 3) // No progress or intermediate{    // Set to something else other than no progress    m_ProgrssStatusCombo.SetCurSel(0); // Normal}</pre></td></tr></table></span></div><br /></li>
        </ol>
        <a name="_Toc280793658" href="#">
          <span />
        </a>
        <p>
          <b>Task 3—Using Taskbar Jump Lists</b>
        </p>
        <a name="_Toc236825883" href="#">
          <span />
        </a>
        <p>In this task, you will add the functionality to support adding known categories, custom categories, destinations, and tasks to the application’s jump list. To support this, MFC provides a new class, CJumpList, that allows manipulating the categories and entries on the Taskbar application’s JumpList.</p>
        <ol>
          <li>In the TaskbarDemo\SourceFiles sub tree, open the file JumpListTab.cpp and look for the implementation of CJumpListTab::UpdateRegistration(). This method executes another process to register needed file associations. The file association registration does not need to be in another process; however it was placed in another process to keep this tutorial application simple and focused.<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td> We need to register the file associations because an application must be a registered file type handler for an item of that type to appear in its Jump List. It does not, however, need to be the default handler for that file type.</td></tr></table><p /></div><br /></li>
          <li> Add the necessary code to update the registry and unregister jpg file associations in the corresponding message handlers:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>void CJumpListTab::OnRegisterFileType(){        // TODO: Register file associations    UpdateRegistration(TRUE);}void CJumpListTab::OnUnregisterFileType(){    // TODO: Unregister file associations    UpdateRegistration(FALSE);}</pre></td></tr></table></span></div><br /></li>
          <li>The next steps will be used to add the necessary code to add the various Jump List items. Here’s a description for each:<p><img src="images\5a9a6e25-3eac-45d4-bab2-0dfe803c2d05.png" /></p><p><b>Figure 6</b><br /><i>Jump List item descriptions</i></p><br /></li>
          <li>To append a known category to the Jump List, add this code to the CJumpListTab::OnAddKnownCategory() event handler:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>int curSel = m_knownCategoryCombo.GetCurSel();if (curSel &lt; 0){    AfxMessageBox(L"Must select a known category above");return;}if (curSel == 0){    if (m_jumpList.AddKnownCategory(KDC_FREQUENT))        m_JumpList_Display_Items.AddString(L"Known Category: Frequent");    else        AfxMessageBox(L"Failed to add Frequent Known Category");} else if (curSel == 1){    if (m_jumpList.AddKnownCategory(KDC_RECENT))        m_JumpList_Display_Items.AddString(L"Known Category: Recent");    else        AfxMessageBox(L"Failed to add Recent Known Category");}</pre></td></tr></table></span></div><br /></li>
          <li>To add a Destination in the Jump List, add this code in the CJumpListTab::OnAddDestination() event handler:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>UpdateData(); // Sync variables to UI controlsif (m_destinationPath.IsEmpty() || m_destinationCategory.IsEmpty()){    AfxMessageBox(L"Both Destination categeory and path must be added.");    return;}if (!m_jumpList.AddDestination(m_destinationCategory, m_destinationPath)){    AfxMessageBox(L"Failed to add destination.");}else{    CString text = L"Destination: " + m_destinationPath;    m_JumpList_Display_Items.AddString(text);}</pre></td></tr></table></span></div><br /></li>
          <li>To add a new task in the Jump List, add this code in the CJumpListTab::OnAddTask() event  handler:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>UpdateData(); // Sync variables to UI controlsif (m_taskPath.IsEmpty() || m_taskTitle.IsEmpty()){    AfxMessageBox(L"Both Task Path and Title must be added.");    return;}if (!m_jumpList.AddTask(m_taskPath, m_taskArgs, m_taskTitle, m_taskIconPath, m_taskIconIndex)){    AfxMessageBox(L"Failed to add Task.");}else{    CString text = L"Task: " + m_taskTitle ;    m_JumpList_Display_Items.AddString(text);}</pre></td></tr></table></span></div><br /></li>
          <li>To allow the removal of all entries from the Jump List, add the following code to the  CJumpListTab::OnClearAll() event handler:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>m_jumpList.ClearAll();m_JumpList_Display_Items.ResetContent();</pre></td></tr></table></span></div><br /></li>
          <li>To commit changes made to the Jump List, add the following code to the  CJumpListTab::OnCommit() event handler:<div class="code"><span codeLanguage="ManagedCPlusPlus"><table width="100%" cellspacing="0" cellpadding="0"><tr><th>C++</th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span></th></tr><tr><td colspan="2"><pre>if (m_jumpList.CommitList()){    m_JumpList_Display_Items.ResetContent();    // Start another list    m_jumpList.InitializeList();}else{    AfxMessageBox(L"Failed to commit jump list.");}</pre></td></tr></table></span></div><br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td> All updates to a JumpList must take place in between calls to CJumpList::InitializeList() and CJumpList::CommitList(), otherwise, additions will fail.</td></tr></table><p /></div><br /></li>
          <li>Build and run the application.</li>
          <li>In the Jump List tab, register the jpeg file association by pressing the <b>Register .jpg file association</b> button.<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td> This registration process will need to run elevated, so UAC will prompt you for elevated privileges.</td></tr></table><p /></div><br /></li>
          <li>In the Jump List tab, start adding items into the Jump List, making sure to click the “Commit” button at the end so added items can appear on the Jump List. Examples of items to be added:<ol><li>Add both Recent and Frequent Known Categories (select <i>Frequent</i> from the Known Category drop-down and then click <b>Add Known Category ==&gt;</b>)</li><li>Add a Destination by filling in Category = “Custom Category” (no quotes) and Path = C:\Users\Public\Pictures\Sample Pictures\Desert.jpg, and then clicking <b>Add Destination ==&gt;</b>.</li><li>Add a Task by filling in Title=”Bing” (no quotes) and Path/Url=http://www.bing.com (Icon is optional), and then clicking <b>Add task ==&gt;</b>.</li><li>Click <b>Commit</b>.</li><li>Right-click on the application’s taskbar button and you’ll observe output that will look similar to the following:</li></ol></li>
          <p>
            <img src="images\4680c153-9412-4ddd-8698-e071123a84bc.png" />
          </p>
          <p>
            <b>Figure 7</b>
            <br />
            <i>Sample Jump List</i>
          </p>
          <br />
        </ol>
      </div>
      <div id="footer">
        <div class="footerLine">
          <img src="../local/footer.gif" alt="Footer image" width="100%" height="3px" />
        </div>To give feedback please write to VSKitFdbk@Microsoft.com<p />Copyright © 2011 by Microsoft Corporation. All rights reserved.</div>
    </div>
  </body>
</html>