<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Пример 3.2</title>
</head>
<body>
    <script type="text/javascript">
        debugger
        // Здесь создается объект, который соответствует дате Рождества в 2007 году
        // Переменная xmas хранит ссылку на объект, а не сам объект
        var xmas = new Date(2007, 11, 25);
        // Затем выполняется копирование ссылки, получается вторая ссылка на оригинальный объект
        var solstice = xmas; // Обе переменные ссылаются на тот же самый объект
        // Здесь выполняется изменение объекта с помощью новой ссылки
        solstice.setDate(21);
        // Изменения можно наблюдать при использовании первой ссылки
        xmas.getDate(); // Возвращает 21, а не первоначальное значение 25
        // То же происходит при передаче объектов и массивов в функции.
        // Следующая функция складывает значения всех элементов массива.
        // Функции передается ссылка на массив, а не копия массива.
        // Благодаря этому функция может изменять содержимое массива, переданного
        // по ссылке, и эти изменения будут видны после возврата из функции.
        function add_to_totals(totals, x) {
            totals[0] = totals[0] + x;
            totals[1] = totals[1] + x;
            totals[2] = totals[2] + x;
        }
        // Наконец, далее выполняется операция сравнения по ссылке.
        // При сравнении двух переменных, созданных ранее, обнаруживается,
        // что они эквивалентны, поскольку ссылаются на один и тот же объект даже
        // при том, что производилось изменение даты по одной из них:
        (xmas == solstice) // Возвращает значение true
        // Две переменные, созданные позднее, ссылаются на разные объекты,
        // каждый из которых содержит одну и ту же дату.
        var xmas = new Date(2007, 11, 25);
        var solstice_plus_4 = new Date(2007, 11, 25);
        // Но согласно правилу "сравнения по ссылке" ссылки на разные объекты
        // не считаются эквивалентными!
        (xmas != solstice_plus_4) // Возвращает значение true
        // Здесь приводится другая версия функции add_to_totals(). Хотя она не работает,
        // потому что вместо изменения самого массива она изменяет ссылку на этот массив.
        function add_to_totals2(totals, x) {
            newtotals = new Array(3);
            newtotals[0] = totals[0] + x;
            newtotals[1] = totals[1] + x;
            newtotals[2] = totals[2] + x;
            totals = newtotals; // Эта строка не оказывает влияния
            // на массив за пределами функции
        }
    </script>
</body>
</html>
